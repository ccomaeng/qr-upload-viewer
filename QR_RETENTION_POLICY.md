# 📅 QR 코드 및 이미지 보존 정책

## 🕒 파일 보존 기간

### 현재 설정
- **이미지 파일**: **7일** (168시간) 후 자동 삭제
- **QR 코드**: **7일** (168시간) 후 자동 삭제
- **데이터베이스 기록**: **7일** 후 자동 삭제

### 자동 정리 시스템
```
AUTO_CLEANUP_ENABLED=true
CLEANUP_INTERVAL_HOURS=24    # 24시간마다 정리 작업 실행
MAX_FILE_AGE_HOURS=168       # 168시간(7일) 후 파일 삭제
```

## 📋 QR 코드 생명주기

### 1단계: 업로드 및 생성 (즉시)
- 이미지 업로드 → 서버 저장
- QR 코드 생성 → `/uploads/qr-codes/` 폴더에 저장
- 데이터베이스에 업로드 정보 기록

### 2단계: 활성 기간 (7일간)
- **QR 스캔**: 정상 작동 ✅
- **이미지 보기**: 정상 표시 ✅
- **다운로드**: 가능 ✅

### 3단계: 자동 삭제 (7일 후)
- **파일 시스템**: 이미지 + QR 파일 삭제
- **데이터베이스**: 업로드 기록 삭제
- **QR 스캔**: 404 오류 (파일 없음) ❌

## 🔍 현재 상태 확인 방법

### 업로드 기록 확인
```bash
# API로 업로드 기록 조회
curl https://qr-upload-viewer-backend.onrender.com/api/uploads
```

### 특정 QR 상태 확인
```bash
# uploadId로 상태 확인
curl https://qr-upload-viewer-backend.onrender.com/api/qr/{uploadId}
```

## ⚠️ 중요 안내

### 사용자 주의사항
1. **QR 코드는 7일 후 만료됩니다**
2. **중요한 이미지는 7일 내에 다운로드하세요**
3. **QR 코드를 장기간 사용할 계획이면 별도 저장 필요**

### 만료된 QR 코드 동작
- 📱 **모바일 스캔**: "이미지를 찾을 수 없습니다" 오류
- 🌐 **브라우저**: 404 페이지 표시
- 💾 **데이터**: 완전히 삭제됨 (복구 불가)

## 🔧 보존 기간 연장 방법

### 환경변수 수정
```bash
# 30일로 연장 (720시간)
MAX_FILE_AGE_HOURS=720

# 무제한 보존 (자동 삭제 비활성화)
AUTO_CLEANUP_ENABLED=false
```

### 프로덕션 환경 적용
1. **Render 대시보드** → **Environment Variables**
2. `MAX_FILE_AGE_HOURS` 값 변경
3. **Manual Deploy** 실행

## 📊 스토리지 사용량

### 현재 추정
- **평균 이미지**: 2-5MB
- **QR 코드**: 10-50KB
- **7일 보존**: 약 50-100MB (이미지 20개 기준)

### 장기 보존 시 고려사항
- **스토리지 비용**: Render 무료 플랜 제한
- **성능 영향**: 파일 수 증가 시 속도 저하
- **백업 필요성**: 중요 데이터 별도 백업

## 🎯 권장사항

### 일반 사용자
- **7일 기본 설정**: 대부분의 용도에 적합
- **중요 이미지**: 즉시 다운로드 권장

### 비즈니스 사용
- **30일 연장**: 업무용 활용 시 권장
- **별도 스토리지**: AWS S3, Google Drive 연동 고려

### 개발자
- **테스트 환경**: 1-2일로 단축 가능
- **프로덕션**: 사용자 요구사항에 따라 조정

---

**💡 팁**: QR 코드 생성 시 만료일을 사용자에게 안내하면 더 좋은 UX를 제공할 수 있습니다.